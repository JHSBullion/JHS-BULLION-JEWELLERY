<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>JHS BULLION & JEWELLERY</title>
  <link rel="stylesheet" href="style.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
</head>
<body>
  <div class="container">
    <h1>JHS BULLION & JEWELLERY</h1>
    <p class="subtitle">马来西亚黄金金价展示网站</p>
    <h2>全马收金最高价</h2>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>MYR / 克</th>
          <th>趋势</th>
        </tr>
      </thead>
      <tbody id="priceTable">
        <tr><td>999.9 BAR(P)</td><td id="p9999P">--</td><td id="t9999P">--</td></tr>
        <tr><td>999.9 BAR</td><td id="p9999">--</td><td id="t9999">--</td></tr>
        <tr><td>999 GOLD</td><td id="p999">--</td><td id="t999">--</td></tr>
        <tr><td>916 GOLD</td><td id="p916">--</td><td id="t916">--</td></tr>
        <tr><td>835 GOLD</td><td id="p835">--</td><td id="t835">--</td></tr>
      </tbody>
    </table>

    <canvas id="goldChart" width="400" height="200" style="margin-top: 40px;"></canvas>
    <div style="text-align: center; margin-top: 10px;">
      <span style="color:#d4af37; font-weight:bold;">● 999 Gold</span>
      &nbsp;&nbsp;&nbsp;
      <span style="color:#ff8800; font-weight:bold;">● 916 Gold</span>
    </div>

    <p id="updateDate">今日更新：--</p>
    <div class="whatsapp">
      <button onclick="window.open('https://wa.me/601154021213', '_blank')">WhatsApp 咨询</button>
    </div>

    <footer>
      <div>JHS JEWELLERY SDN BHD. 07-3511104</div>
      <div><a href="https://www.jhsbullion.com" style="color: #b88c00; text-decoration: none;">www.jhsbullion.com</a></div>
      <div class="social">
        <a href="https://www.facebook.com/share/17GxKng5DB/?mibextid=wwXIfr" target="_blank"><i class="fab fa-facebook-f"></i></a>
        <a href="https://www.instagram.com/jhs_bullion_and_jewellery" target="_blank"><i class="fab fa-instagram"></i></a>
      </div>
    </footer>
  </div>

  <script src="js/data.js"></script>
  <script>
    const table = {
      "999.9P": document.getElementById("p9999P"),
      "999.9": document.getElementById("p9999"),
      "999": document.getElementById("p999"),
      "916": document.getElementById("p916"),
      "835": document.getElementById("p835")
    };
    const trend = {
      "999.9P": document.getElementById("t9999P"),
      "999.9": document.getElementById("t9999"),
      "999": document.getElementById("t999"),
      "916": document.getElementById("t916"),
      "835": document.getElementById("t835")
    };

    const data = window.goldPrices || {};
    const today = new Date().toISOString().slice(0, 10);
    document.getElementById("updateDate").textContent = "今日更新：" + today;

    for (let key in table) {
      const price = data[key]?.current || "--";
      const diff = data[key]?.diff;
      table[key].textContent = price;
      trend[key].innerHTML = diff > 0
        ? `<span style='color:green'>▲ ${diff}</span>`
        : diff < 0
        ? `<span style='color:red'>▼ ${Math.abs(diff)}</span>` : "--";
    }

    // 日期与价格读取
    function getHistorySeries(goldType) {
      const series = data[goldType]?.history || [];
      return {
        labels: series.map(item => item.date?.slice(5) || "--"),
        values: series.map(item => item.value)
      };
    }

    const chart999 = getHistorySeries("999");
    const chart916 = getHistorySeries("916");

    const ctx = document.getElementById("goldChart").getContext("2d");
    new Chart(ctx, {
      type: "line",
      data: {
        labels: chart999.labels,
        datasets: [
          {
            label: "999 GOLD",
            data: chart999.values,
            borderColor: "#d4af37",
            backgroundColor: "#d4af37",
            fill: false,
            tension: 0.3
          },
          {
            label: "916 GOLD",
            data: chart916.values,
            borderColor: "#ff8800",
            backgroundColor: "#ff8800",
            fill: false,
            tension: 0.3
          }
        ]
      },
      options: {
        responsive: true,
        plugins: { legend: { display: false } },
        scales: { y: { beginAtZero: false } }
      }
    });
  </script>
</body>
</html>
